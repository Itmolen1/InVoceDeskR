@using CaptchaMvc.HtmlHelpers
@{
    Layout = null;
}

<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <!-- Tell the browser to be responsive to screen width -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <!-- Favicon icon -->
    <link rel="icon" type="image/png" sizes="16x16" href="../assets/images/favicon.png">
    <title>Elegant Admin Template - The Ultimate Multipurpose admin template</title>
    <!-- page css -->
    <link href="~/dist/css/pages/login-register-lock.css" rel="stylesheet" />
    <!-- Custom CSS -->
    <link href="~/dist/css/style.min.css" rel="stylesheet">
    <link href="../dist/css/pages/floating-label.css" rel="stylesheet">
    <link href="~/assets/node_modules/sweetalert/sweetalert.css" rel="stylesheet" />
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>
<body class="horizontal-nav skin-default card-no-border">
    <div class="preloader">
        <div class="loader">
            <div class="loader__figure"></div>
            <p class="loader__label">Please wait...</p>
        </div>
    </div>

    <section id="wrapper">
        <div class="login-register" style="background-image:url(../assets/images/background/login-register.jpg);">
            <div class="login-box card">
                <div class="card-body">
                    <form class="form-horizontal form-material" id="loginform">
                        <h3 class="box-title m-b-20">Sign In</h3>
                        <div class="form-group ">
                            <div class="col-xs-12">
                                <input class="form-control" type="text" required id="txtUsername" placeholder="Username">
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="col-xs-12">
                                <input class="form-control" type="password" required id="txtPassword" placeholder="Password">
                            </div>
                        </div>
                        @*<div class="form-group">
                            <div class="col-xs-12 ti-align-center">
                                @Html.Captcha(5)@ViewBag.ErrorMessage
                            </div>
                        </div>*@


                        <div class="form-group row">
                            <div class="col-md-12">
                                <div class="custom-control custom-checkbox">
                                    <input type="checkbox" class="custom-control-input" id="customCheck1">
                                    <label class="custom-control-label" for="customCheck1">Remember me</label>
                                    <a href="javascript:void(0)" id="to-recover" class="text-dark pull-right"><i class="fa fa-lock m-r-5"></i> Forgot pwd?</a>
                                </div>
                            </div>
                        </div>
                        <div class="form-group text-center">
                            <div class="col-xs-12 p-b-20">

                                <input id="btnLogin" class="btn btn-block btn-lg btn-info btn-rounded" type="button" value="Login" />
                                <input id="ShowModel" class="btn btn-block btn-lg btn-info btn-rounded" type="button" value="Model" />
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-xs-12 col-sm-12 col-md-12 m-t-10 text-center">
                                <div class="social">
                                    <a href="javascript:void(0)" class="btn  btn-facebook" data-toggle="tooltip" title="Login with Facebook"> <i aria-hidden="true" class="fa fa-facebook"></i> </a>
                                    <a href="javascript:void(0)" class="btn btn-googleplus" data-toggle="tooltip" title="Login with Google"> <i aria-hidden="true" id="LoginWithGoogle" class="fa fa-google-plus"></i> </a>
                                </div>
                            </div>
                        </div>
                        <div class="form-group m-b-0">
                            <div class="col-sm-12 text-center">
                                Don't have an account? <a href="/Login/RegisterNew" class="text-info m-l-5"><b>Sign Up</b></a>
                            </div>
                        </div>
                    </form>
                    <form class="form-horizontal" id="recoverform">
                        <div class="form-group ">
                            <div class="col-xs-12">
                                <h3>Recover Password</h3>
                                <p class="text-muted">Enter your Email and instructions will be sent to you! </p>
                            </div>
                        </div>
                        <div class="form-group ">
                            <div class="col-xs-12">
                                <input class="form-control" type="text" required="" placeholder="Email">
                            </div>
                        </div>
                        <div class="form-group text-center m-t-20">
                            <div class="col-xs-12">
                                <button class="btn btn-primary btn-lg btn-block text-uppercase waves-effect waves-light" type="submit">Reset</button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <div class="modal fade bs-example-modal-lg" id="CompanyModal" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true" style="display: none;">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <div class="modal-header">
                        <h4 class="modal-title" id="myLargeModalLabel">Register your company here... </h4>
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                    </div>
                    <div class="modal-body">
                     
                            <div class="row">
                                <div class="col-sm-6">
                                    <div class="form-group">
                                        <div class="col-xs-12">
                                            <input class="form-control" type="text" required id="CompanyName" placeholder="Company Name">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <div class="col-xs-12">
                                            <input class="form-control" type="text" required id="CompanyAddress" placeholder="Company Address">
                                        </div>
                                    </div>
                                    <div class="row" style="margin-top:5px">
                                        <div class="col-sm-6">
                                            <input class="form-control" type="text" required id="PostalCode" placeholder="Postal Code">
                                        </div>
                                        <div class="col-sm-6">
                                            <input class="form-control" type="text" required id="CompanyCity" placeholder="City">
                                        </div>
                                    </div>

                                    <div class="form-group" style="margin-top:25px">
                                        <div class="col-xs-12">
                                            <input class="form-control" type="text" required id="CompanyPhone" placeholder="Company Phone landline">
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <div class="col-xs-12">
                                            <input class="form-control" type="text" required id="CompanyEmail" placeholder="Company Email">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <div class="col-xs-12">
                                            <input class="form-control" type="text" required id="BankName" placeholder="Bank Name">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <div class="col-xs-12">
                                            <input class="form-control" type="text" required id="BIC" placeholder="BIC">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <div class="col-xs-12">
                                            <input class="form-control" type="text" required id="BTW" placeholder="BTW">
                                        </div>
                                    </div>                            
                                      
                                    </div>
                                <div class="col-sm-6">
                                    <div class="form-group">
                                        <input type="file" name="file"  id="FileUpload1" />
                                        <img class="img-responsive" id="targetImg" style="height:38px;width:38px" />
                                    </div>

                                    <div class="form-group" style="margin-top:5px">
                                        <div class="col-xs-12">
                                            <input class="form-control" type="text" required id="StreetNumber" placeholder="Street Number">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <div class="col-xs-12">
                                            <input class="form-control" type="text" required id="CompanyCountry" placeholder="Company Country">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <div class="col-xs-12">
                                            <input class="form-control" type="text" required id="CompanyCell" placeholder="Company Cell or mobile">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <div class="col-xs-12">
                                            <input class="form-control" type="text" required id="Website" placeholder="Company Website">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <div class="col-xs-12">
                                            <input class="form-control" type="text" required id="IBANNumber" placeholder="IBAN Number">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <div class="col-xs-12">
                                            <input class="form-control" type="text" required id="KVK" placeholder="KVK">
                                        </div>
                                    </div>                                
                                </div>
                            </div>
                        
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn waves-effect waves-light btn-rounded btn-success" id="SaveCompanyInformation">Submit</button>
                        <button type="button" class="btn waves-effect waves-light btn-rounded btn-danger" data-dismiss="modal">Close</button>
                    </div>
                </div>
                <!-- /.modal-content -->
            </div>
            <!-- /.modal-dialog -->
        </div>
        <div class="preloader">
            <div class="loader">
                <div class="loader__figure"></div>
                <p class="loader__label">Invoice Desk loading...</p>
            </div>
        </div>
    </section>

    <!-- ============================================================== -->
    <!-- All Jquery -->
    <!-- ============================================================== -->
    <script src="~/assets/node_modules/jquery/jquery-3.2.1.min.js"></script>
    <!-- Bootstrap tether Core JavaScript -->
    <script src="~/assets/node_modules/popper/popper.min.js"></script>
    <script src="~/assets/node_modules/bootstrap/dist/js/bootstrap.min.js"></script>
    <script src="~/assets/node_modules/sweetalert/jquery.sweet-alert.custom.js"></script>
    <script src="~/assets/node_modules/sweetalert/sweetalert.min.js"></script>
    @*<script src="https://www.google.com/recaptcha/api.js" async defer></script>*@
    <!--Custom JavaScript -->
    <script>
        $(document).ready(function () 
        {

            //$('#CaptchaInputText').addClass('form-control');            
         
            //function validateLogin() {
            //    var isValid = true;
            //    if ($('#CaptchaInputText').val().trim() == "") {
            //        $('#CaptchaInputText').css('border-color', 'Red');
            //        isValid = false;
            //    }              
            //    return isValid;
            //}
            if (sessionStorage.getItem('accessToken') != null) 
            {
                window.location.href = "/Home/Index";
            }
            else {
                $('#btnLogin').click(function () {
                        $.ajax({
                            url: '/token',
                            method: 'POST',
                            contentType: 'application/json',                         
                            data: {
                                username: $('#txtUsername').val(),
                                password: $('#txtPassword').val(),
                               
                               grant_type: 'password'

                            },
                            success: function (response) {
                                sessionStorage.setItem('accessToken', response.access_token);
                                localStorage.setItem('Username', response.userName);
                                //..........
                                $.ajax({
                                    //url: 'http://localhost:63861/api/ApiCompanyStatus/',
                                    url: '/api/ApiCompanyStatus/',
                                    //url: 'http://itmolen-001-site4.htempurl.com/api/ApiCompanyStatus/',
                                    method: 'GET',
                                    contentType: 'application/json',

                                    data: {
                                        id: $('#txtUsername').val()
                                    },
                                    success: function (CompanyStatus) {
                                        if (CompanyStatus > 0) {
                                            $.ajax({
                                                url: '/MVCComapny/GetCompanyInfo',
                                                method: 'GET',
                                                contentType: 'application/json',                                              
                                                data: {
                                                    ID: CompanyStatus

                                                },
                                                success: function (CompanyInfo) {
                                                    localStorage.setItem('CompanyID', CompanyInfo.CompanyID);
                                                    localStorage.setItem('CompanyName', CompanyInfo.CompanyName);;
                                                    localStorage.setItem('CompanyLogo', CompanyInfo.CompanyLogo);
                                                    window.location.href = '/Home/Index';
                                                },
                                                error: function (jqerr) {
                                                    alert('Some thing went wrong Try aganin later' + JSON.stringify(jqerr));
                                                }
                                            });

                                        }
                                        else {
                                            $('#CompanyModal').modal('show');
                                        }
                                    },
                                    error: function (jqerr) {
                                        alert('Errr' + JSON.stringify(jqerr));
                                    }
                                });

                                //..........

                            },
                            error: function (jqHXR) {
                                alert('Incorrect username or password');
                            }
                        });
                   
                });
            }
            });
    </script>


    <script>
        $(function () {
            $(".preloader").fadeOut();
        });
        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        });

        // ==============================================================
        // Login and Recover Password
        // ==============================================================
        $('#to-recover').on("click", function () {
            $("#loginform").slideUp();
            $("#recoverform").fadeIn();
        });

      
    </script>

  

    <script>
        $(document).ready(function () {
            $("#SaveCompanyInformation").click(function (e) {
                if (window.FormData !== undefined) {

                    var fileUpload = $("#FileUpload1").get(0);
                    var files = fileUpload.files;

                    // Create FormData object
                    var fileData = new FormData();

                    // Looping over all files and add it to FormData object
                    for (var i = 0; i < files.length; i++) {
                        fileData.append(files[i].name, files[i]);
                    }

                    // Adding one more key to FormData object
                    fileData.append('CompanyName', $('#CompanyName').val());
                    fileData.append('CompanyAddress', $('#CompanyAddress').val());
                    fileData.append('CompanyPhone', $('#CompanyPhone').val());
                    fileData.append('CompanyCell', $('#CompanyCell').val());
                    fileData.append('CompanyEmail', $('#CompanyEmail').val());
                    fileData.append('CompanyLogo', $('#CompanyLogo').val());                
                    fileData.append('CompanyCity', $('#CompanyCity').val());
                    fileData.append('CompanyCountry', $('#CompanyCountry').val());
                    fileData.append('StreetNumber', $('#StreetNumber').val());
                 
                    fileData.append('PostalCode', $('#PostalCode').val());
                    fileData.append('Website', $('#Website').val());
                    fileData.append('BankName', $('#BankName').val());

                    fileData.append('IBANNumber', $('#IBANNumber').val());
                    fileData.append('BIC', $('#BIC').val());
                    fileData.append('KVK', $('#KVK').val());

                    fileData.append('BTW', $('#BTW').val());

                    fileData.append('AddedDate', $('#AddedDate').val());
                    fileData.append('UserName', localStorage.getItem('Username'));

                    var apiurl = "/MVCComapny/AddOrEdit";

                    $.ajax({
                        url: apiurl,
                        type: 'POST',
                        data: fileData,
                        processData: false,
                        contentType: false,
                        success: function (ReturnStatus) {
                            if (ReturnStatus == 201) {
                                SuccessInsert();
                                window.location.href = '/Home/Index';
                            }
                        },
                        error: function () {
                            alert("Error please try again");
                        }
                    });
                }
            });
        });
    </script>

    <script>
        $('#LoginWithGoogle').click(function () {
            alert('yes Google')
        });
    </script>

    <script>

        $('#ShowModel').click(function () {
            $('#CompanyModal').modal('show');

        });


        var ClearPreview = function () {
            $('#ImageBrows').val('');
            $('#Description').val('');
            $('#ImagePreview').val('');
        }

    </script>

    <script>

        $(document).ready(function () {

            function readURL(input) {

                if (input.files && input.files[0]) {
                    var reader = new FileReader();

                    reader.onload = function (e) {
                        $('#targetImg').attr('src', e.target.result);
                    }

                    reader.readAsDataURL(input.files[0]);
                }
            }

            $("#FileUpload1").change(function () {
                readURL(this);
            });
        });

        var $loading = $('.preloader').hide();

        $(document)
          .ajaxStart(function () {
              $loading.show();
          })
          .ajaxStop(function () {
              $loading.hide();
          });



        function SuccessInsert() {
            swal({
                title: "Congratulations!",
                text: "Your data has been saved successfully",
                type: "success",
            });
        }
    </script>

</body>
</html>
